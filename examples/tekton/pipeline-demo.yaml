apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: demo-pipeline
  namespace: github-poller
  annotations:
    description: "GitHub Poller ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¢ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³"
spec:
  description: |
    GitHub Poller ã«ã‚ˆã£ã¦è‡ªå‹•çš„ã«èµ·å‹•ã•ã‚Œã‚‹ãƒ‡ãƒ¢ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã€‚
    ãƒªãƒã‚¸ãƒˆãƒªã®å¤‰æ›´ã‚’æ¤œå‡ºã™ã‚‹ã¨ã€ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
  
  params:
    - name: repo-url
      type: string
      description: "GitHub ãƒªãƒã‚¸ãƒˆãƒªã® URL"
      default: "https://github.com/example/repo"
    
    - name: branch
      type: string
      description: "ãƒ–ãƒ©ãƒ³ãƒå"
      default: "main"
  
  tasks:
    - name: start-notification
      taskRef:
        name: echo-task
      params:
        - name: message
          value: "ğŸš€ Pipeline Started - Change detected by GitHub Poller!"
        - name: repo-url
          value: $(params.repo-url)
        - name: branch
          value: $(params.branch)
    
    - name: fetch-info
      runAfter:
        - start-notification
      taskRef:
        name: echo-task
      params:
        - name: message
          value: "ğŸ“¥ Fetching repository information..."
        - name: repo-url
          value: $(params.repo-url)
        - name: branch
          value: $(params.branch)
    
    - name: build-simulation
      runAfter:
        - fetch-info
      taskRef:
        name: echo-task
      params:
        - name: message
          value: "ğŸ”¨ Simulating build process..."
        - name: repo-url
          value: $(params.repo-url)
        - name: branch
          value: $(params.branch)
    
    - name: test-simulation
      runAfter:
        - build-simulation
      taskRef:
        name: echo-task
      params:
        - name: message
          value: "ğŸ§ª Simulating test execution..."
        - name: repo-url
          value: $(params.repo-url)
        - name: branch
          value: $(params.branch)
    
    - name: completion-notification
      runAfter:
        - test-simulation
      taskRef:
        name: echo-task
      params:
        - name: message
          value: "âœ… Pipeline Completed Successfully!"
        - name: repo-url
          value: $(params.repo-url)
        - name: branch
          value: $(params.branch)

