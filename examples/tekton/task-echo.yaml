apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: echo-task
  namespace: default
  annotations:
    description: "ã‚·ãƒ³ãƒ—ãƒ«ãª Echo ã‚¿ã‚¹ã‚¯ - GitHub Poller ã®ãƒ†ã‚¹ãƒˆç”¨"
spec:
  description: |
    ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã£ã¦æ¨™æº–å‡ºåŠ›ã«è¡¨ç¤ºã™ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¿ã‚¹ã‚¯ã€‚
    GitHub Poller ã«ã‚ˆã£ã¦ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒèµ·å‹•ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚
  
  params:
    - name: message
      type: string
      description: "è¡¨ç¤ºã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
      default: "Hello from Tekton!"
    
    - name: repo-url
      type: string
      description: "ãƒªãƒã‚¸ãƒˆãƒªã® URL"
      default: "N/A"
    
    - name: branch
      type: string
      description: "ãƒ–ãƒ©ãƒ³ãƒå"
      default: "main"
  
  steps:
    - name: echo-header
      image: registry.access.redhat.com/ubi9/ubi-minimal:latest
      script: |
        #!/bin/bash
        echo "=================================================================="
        echo "  Tekton Pipeline Triggered by GitHub Poller"
        echo "=================================================================="
        echo ""
    
    - name: echo-params
      image: registry.access.redhat.com/ubi9/ubi-minimal:latest
      script: |
        #!/bin/bash
        echo "ğŸ“‹ Pipeline Parameters:"
        echo "  â€¢ Message:     $(params.message)"
        echo "  â€¢ Repository:  $(params.repo-url)"
        echo "  â€¢ Branch:      $(params.branch)"
        echo ""
    
    - name: echo-timestamp
      image: registry.access.redhat.com/ubi9/ubi-minimal:latest
      script: |
        #!/bin/bash
        echo "ğŸ• Execution Time:"
        echo "  â€¢ Date: $(date '+%Y-%m-%d')"
        echo "  â€¢ Time: $(date '+%H:%M:%S %Z')"
        echo "  â€¢ Timestamp: $(date '+%s')"
        echo ""
    
    - name: echo-environment
      image: registry.access.redhat.com/ubi9/ubi-minimal:latest
      script: |
        #!/bin/bash
        echo "ğŸ–¥ï¸  Environment:"
        echo "  â€¢ Hostname: $(hostname)"
        echo "  â€¢ User: $(whoami)"
        echo "  â€¢ Working Dir: $(pwd)"
        echo ""
    
    - name: simulate-work
      image: registry.access.redhat.com/ubi9/ubi-minimal:latest
      script: |
        #!/bin/bash
        echo "âš™ï¸  Simulating work..."
        for i in {1..5}; do
          echo "  Step $i/5 - Processing..."
          sleep 1
        done
        echo "  âœ… Work completed successfully!"
        echo ""
    
    - name: echo-footer
      image: registry.access.redhat.com/ubi9/ubi-minimal:latest
      script: |
        #!/bin/bash
        echo "=================================================================="
        echo "  âœ… Pipeline Execution Completed Successfully"
        echo "=================================================================="
        echo ""
        echo "This pipeline was automatically triggered by GitHub Poller"
        echo "when a change was detected in the repository."
        echo ""

