apiVersion: v1
kind: ConfigMap
metadata:
  name: github-poller-config
  namespace: github-poller
data:
  config.yaml: |
    repositories:
      # サンプル設定 1: シンプルなリポジトリ監視
      # プレースホルダー ${repo.url}, ${repo.branch}, ${repo.name} を使用可能
      - name: "my-application"
        url: "https://github.com/your-org/my-application"
        branch: "main"
        pipeline: "build-and-deploy"
        params:
          - name: "repo-url"
            value: "${repo.url}"
          - name: "branch"
            value: "${repo.branch}"
        lastCheckedSHA: ""
      
      # サンプル設定 2: ワークスペースとサービスアカウントを含む設定
      - name: "api-service"
        url: "https://github.com/your-org/api-service"
        branch: "develop"
        pipeline: "api-build-pipeline"
        serviceAccount: "tekton-pipeline-sa"
        params:
          - name: "repo-url"
            value: "${repo.url}"
          - name: "branch"
            value: "${repo.branch}"
          - name: "image-tag"
            value: "latest"
        workspaces:
          - name: "source"
            claimName: "pipeline-workspace-pvc"
        lastCheckedSHA: ""
      
      # サンプル設定 3: プレースホルダーと固定値の組み合わせ
      - name: "frontend-app"
        url: "https://github.com/your-org/frontend-app"
        branch: "staging"
        pipeline: "frontend-pipeline"
        params:
          - name: "repo-url"
            value: "${repo.url}"
          - name: "branch"
            value: "${repo.branch}"
          - name: "environment"
            value: "staging"
          - name: "deploy-target"
            value: "k8s-staging"
          - name: "app-name"
            value: "${repo.name}"
        lastCheckedSHA: ""

